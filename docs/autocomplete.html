<!DOCTYPE html><html><head><title>Mk[ui]</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../docs/assets/css/bootstrap.css"><link rel="stylesheet" type="text/css" href="../docs/assets/css/prism.css"><link rel="stylesheet" type="text/css" href="../docs/assets/css/theme.css"><link rel="stylesheet" type="text/css" href="../dist/css/autocomplete.css"></head><body><header><nav class="navbar navbar-default navbar-theme"><div class="navbar-header"><div class="navbar-brand clearfix"><img class="navbar-logo" src="../docs/assets/images/logo.png"><span class="navbar-details"><span class="navbar-title">/Autocomplete [ac]</span><span class="navbar-quote">A Flexible UI Built on Accessibility</span></span></div></div><ul class="nav navbar-top"><li class="active"><a target="_blank" href="http://codepen.io/micha3ldavid/post/mk-ui">Codepen</a></li><li><a target="_blank" href="https://github.com/micha3ldavid/mk-ui">Github</a></li></ul></nav></header><main class="container"><div class="row"><div class="col-sm-6"><h2>Dependencies</h2><table class="table"><thead><tr><th>Name</th><th>File</th></tr></thead><tbody><tr><td><a href="../">Core</a></td><td>dist/js/core.js</td></tr><tr><td><a href="./docs/selectmenu.html">Selectmenu</a></td><td>dist/js/selectmenu.js</td></tr></tbody></table></div><div class="col-sm-6"><h2>Assets</h2><table class="table"><thead><tr><th>Type</th><th>File</th></tr></thead><tbody><tr><td>js</td><td>dist/js/autocomplete.js</td></tr><tr><td>css</td><td>dist/css/autocomplete.css</td></tr><tr><td>less</td><td>dist/less/autocomplete.less</td></tr><tr><td>scss</td><td>dist/scss/autocomplete.scss</td></tr></tbody></table></div></div><h2>Examples</h2><div class="row"><div class="col-sm-4"><section class="panel"><header class="panel-heading"><h2 class="panel-title">Static Data</h2></header><div class="panel-body"><div class="mk-ac-root"><input class="mk-ac" type="text" placeholder="Movie Genres" name="symbol-1"></div></div></section></div><div class="col-sm-4"><section class="panel"><header class="panel-heading"><h2 class="panel-title">Up to Four Selections</h2></header><div class="panel-body"><div class="mk-ac-root"><input class="mk-ac" type="text" placeholder="Movie Genres" name="symbol-2" data-limit="4"></div></div></section></div><div class="col-sm-4"><section class="panel"><header class="panel-heading"><h2 class="panel-title">Remote URLs</h2></header><div class="panel-body"><div class="mk-ac-root" id="remote"><input class="mk-ac" type="text" placeholder="Search for a symbol" name="symbol-1" data-limit="4"></div></div></section></div></div><div class="row"><div class="col-sm-6"><section class="panel"><header class="panel-heading"><h2 class="panel-title">Comma Seperate</h2></header><div class="panel-body"><div class="mk-ac-root"><input class="mk-ac" type="text" placeholder="Movie Genres" name="symbol-3" data-limit="4" data-comma="true"></div></div></section></div><div class="col-sm-6"><section class="panel"><header class="panel-heading"><h2 class="panel-title">Only Allow Result Selections</h2></header><div class="panel-body"><div class="mk-ac-root"><input class="mk-ac" type="text" placeholder="Movie Genres" name="symbol-4" data-limit="4" data-anything="false"></div></div></section></div></div><div class="row"><div class="col-sm-12"><section class="panel"><header class="panel-heading"><h2 class="panel-title">Removed Tag UI</h2></header><div class="panel-body"><div class="mk-ac-root"><input class="mk-ac" type="text" placeholder="Movie Genres" name="symbol-5" data-comma="true" data-notags="true"></div></div></section></div></div><h2>Events</h2><p>All events are part of the Mk EventEmitter and *not* added to the DOM.
Events are also called in context of the component instance so it isn't a great idea to use a proxy function to change context, as you'll loose a lot of beneficial object access.</p><div class="row"><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">render</h3></header><div class="panel-body"><p>Fired when data has been retrieved and the list is ready to be built. Binding this event replaces the original rending with your own, custom, rendering.</p><pre><code class="language-javascript">
instance.on('render', function (data) {
	console.info(data);
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">change</h3></header><div class="panel-body"><p>Fires when autocomplete value changes.</p><pre><code class="language-javascript">
instance.on('change', function () {
	console.info('base 64:', this.value);
	console.info('raw objects:', this.selections);
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">show</h3></header><div class="panel-body"><p>Fired when menu is shown.</p><pre><code class="language-javascript">
instance.on('show', function () {
	console.info('Menu has opened!');
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">hide</h3></header><div class="panel-body"><p>Fired when menu is hidden.</p><pre><code class="language-javascript">
instance.on('hide', function () {
	console.info('Menu has closed!');
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">activate</h3></header><div class="panel-body"><p>Fired when an option becomes active.</p><pre><code class="language-javascript">
instance.on('activate', function (option, keyboard) {
	console.info('active option:', option);
	console.info('came from keyboard (vs mouse):', keyboard);
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">disabled</h3></header><div class="panel-body"><p>Fired when selectmenu is disabled, if previously enabled.</p><pre><code class="language-javascript">
instance.on('disabled', function () {
	console.info('Selectmenu has been diabled.');
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">enabled</h3></header><div class="panel-body"><p>Fired when selectmenu is enabled, if previously disabled.</p><pre><code class="language-javascript">
instance.on('enabled', function () {
	console.info('Selectmenu has become enabled.');
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">update</h3></header><div class="panel-body"><p>Fired when updates are made to the rendered UI through the use of update().</p><pre><code class="language-javascript">
instance.on('update', function () {
	console.info('Changes to the native select have been applied to the UI.');
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">capacity</h3></header><div class="panel-body"><p>Fired when you've reached the selection limit. Does not fire for single selects.</p><pre><code class="language-javascript">
instance.on('capacity', function () {
	console.info('We reached capacity!');
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">create.tag</h3></header><div class="panel-body"><p>Fired when the trigger input value (label) changes.</p><pre><code class="language-javascript">
instance.on('create.label', function (o) {
	o.label = o.node.text() + ' new label!';
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">request.error</h3></header><div class="panel-body"><p>Since remote requests are left the end developers, this event must be emit by the end developer as well, typically in an error handler. Since the end developer emits this event, you may pass in any arguments you like.</p><pre><code class="language-javascript">
instance.on('request.error', function () {
	console.info('request failed');
});
		</code></pre></div></section></div><div class="col-sm-6"><section class="panel panel-event"><header class="panel-heading"><h3 class="panel-title">request.abort</h3></header><div class="panel-body"><p>Fired when a request is being aborted.</p><pre><code class="language-javascript">
instance.on('request.abort', function () {
	console.info('my request is being aborted due to new user actions.');
});
		</code></pre></div></section></div></div><h2>API</h2><p>Below are the different public properties and methods accessible to you, the end developer.
All of these are accessible on your Autocomplete [ac] instance as well as inside event handlers bound to your instance.
Some methods have intentionally been left out due to their difficulty tof use for end developers vs. internal use.</p><div class="row"><div class="col-sm-6"><h3>Methods</h3><ul class="list-unstyled list-methods"><li><h4><em>instance</em><span>.move([up])</span></h4><p>Move the active list item up or down from the currently activated.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>up</dd></dl><dl><dt>Type</dt><dd>Boolean</dd></dl><dl><dt>Description</dt><dd>Set to true to move up the list. Default is false.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.search(key[, add])</span></h4><p>Runs a search for the query.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>key</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>a string representing query text.</dd></dl></li><li><dl><dt>Name</dt><dd>add</dd></dl><dl><dt>Type</dt><dd>Boolean</dd></dl><dl><dt>Description</dt><dd>Add the the current query, or replace the current query. Default is false (replace).</dd></dl></li></ul></li><li><h4><em>instance</em><span>.request()</span></h4><p>Invokes the request event handlers associated with the autocomplete instance. If your autocomplete uses dynaimc data (API endpoints), setup a requset event to hook your requset into.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.flatten(value)</span></h4><p>Invokes JSON.stringify and btoa on an object.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>value</dd></dl><dl><dt>Type</dt><dd>Object</dd></dl><dl><dt>Description</dt><dd>Object to convert to a flattened string.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.unflatten(value)</span></h4><p>Invokes atob and JSON.parse on a string.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>value</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>String to convert back into an object.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.hasCache(key)</span></h4><p>Returns true when cache exists for a query, false when it does not.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>key</dd></dl><dl><dt>Type</dt><dd>string</dd></dl><dl><dt>Description</dt><dd>a previously searched query.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.getCache(key)</span></h4><p>Returns data for a previously cached query.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>key</dd></dl><dl><dt>Type</dt><dd>string</dd></dl><dl><dt>Description</dt><dd>a previously searched query.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.setCache(key, data)</span></h4><p>Caches object for a given query.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>key</dd></dl><dl><dt>Type</dt><dd>string</dd></dl><dl><dt>Description</dt><dd>a string represending query text.</dd></dl></li><li><dl><dt>Name</dt><dd>data</dd></dl><dl><dt>Type</dt><dd>Object/Array</dd></dl><dl><dt>Description</dt><dd>Object to be cached.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.data([value])</span></h4><p>Generate a JSON representation of the current autocomplete state.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>value</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>Cache key for query data. Empty will give you static data (if provided).</dd></dl></li></ul></li><li><h4><em>instance</em><span>.filterData(key, data)</span></h4><p>Filters a dataset by query text.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>key</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>a string represending query text.</dd></dl></li><li><dl><dt>Name</dt><dd>data</dd></dl><dl><dt>Type</dt><dd>Array</dd></dl><dl><dt>Description</dt><dd>A dataset as Array (typically of objects).</dd></dl></li></ul></li><li><h4><em>instance</em><span>.prepData(data[, query])</span></h4><p>Prep a date set for use with templating and user interactions.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>data</dd></dl><dl><dt>Type</dt><dd>Array</dd></dl><dl><dt>Description</dt><dd>An array of (typically) objects. Objects must contain a 'value' and 'label' property for templating and mapping.</dd></dl></li><li><dl><dt>Name</dt><dd>query</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>A text term used for term highlighting results for the user.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.select(value)</span></h4><p>Selects a value from results, or a custom value provided by you.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>value</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>a flattened string representing a selection object.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.deselect(value)</span></h4><p>Deselects a value from results, or a custom value provided by you.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>value</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>a flattened string representing a selection object.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.deselectAll()</span></h4><p>Removes all current selections.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.exists(value)</span></h4><p>Check raw object against autocomplete selections for a match.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>value</dd></dl><dl><dt>Type</dt><dd>Object</dd></dl><dl><dt>Description</dt><dd>Object with a property named 'value' to check for selection matches.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.abort()</span></h4><p>Invokes the abort event to let end developer know they should cancel their current request, if any.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.error()</span></h4><p>Method invoked when request error event is emit. When making requests for search term data, if an error occurs, emit the error event to invoke this functionality.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.blur()</span></h4><p>Invokes XHR abort event and stops internal loading processes.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.clear()</span></h4><p>Clears screen reader text, list results, and close the menu.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.pop()</span></h4><p>Pop a selection from the current collection.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.notify(type[, query])</span></h4><p>Sends text notifications to the screen reader about the state of the Autocomplete. Also applies state classes (request loading for example) to the Autocomplete.</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>type</dd></dl><dl><dt>Type</dt><dd>CONSTANT</dd></dl><dl><dt>Description</dt><dd>CONSTANT value from instance.NOTIFY_STATES which determines what format text to use for screen readers and user message updating.</dd></dl></li><li><dl><dt>Name</dt><dd>query</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>Used in the format text for screen readers and user message updates.</dd></dl></li><li><dl><dt>Name</dt><dd>count</dd></dl><dl><dt>Type</dt><dd>Number</dd></dl><dl><dt>Description</dt><dd>Result count. Only used for the NOTIFY_STATES.LOADED type representing the number of results returned from the request.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.updateRoot()</span></h4><p>Updates the root input to reflect the current Autocomplete selections.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.render(data[, query])</span></h4><p>Renders a result list based off the data parameter provided</p><h5>Parameters</h5><ul class="list-unstyled list-params"><li><dl><dt>Name</dt><dd>data</dd></dl><dl><dt>Type</dt><dd>Array</dd></dl><dl><dt>Description</dt><dd>Array of data objects to create a list from. Data objects must contain a 'label' and 'value' property.</dd></dl></li><li><dl><dt>Name</dt><dd>query</dd></dl><dl><dt>Type</dt><dd>String</dd></dl><dl><dt>Description</dt><dd>The query term representing the data set. Used for screen readers. If not provided, default is instance.query property.</dd></dl></li></ul></li><li><h4><em>instance</em><span>.unmount()</span></h4><p>Remove all mounted nodes, data, events, and cache associated with the Autocomplete instance to free up memory and resources.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li><li><h4><em>instance</em><span>.update()</span></h4><p>Make changes to your original input then call this for the UI to consume new changes.</p><ul class="list-unstyled list-params"><li><strong>No params required.</strong></li></ul></li></ul></div><div class="col-sm-6"><h3>Properties</h3><ul class="list-unstyled list-property"><li><h4><em>instance.</em><span>input</span></h4><p>The wrapped, rendered triggering input element.</p></li><li><h4><em>instance.</em><span>tagroot</span></h4><p>The wrapped root element holding tags.</p></li><li><h4><em>instance.</em><span>tags</span></h4><p>The wrapped collection of UI tags.</p></li><li><h4><em>instance.</em><span>live</span></h4><p>The wrapped live element responsible for updating screen reader users with atomic information.</p></li><li><h4><em>instance.</em><span>notifications</span></h4><p>Similar to the live element, but hold notifications such as when a request fails.</p></li><li><h4><em>instance.</em><span>isLoading</span></h4><p>Boolean representing if the autocomplete is requesting data.</p></li><li><h4><em>instance.</em><span>limit</span></h4><p>Number of selections an autocompelete instance can have</p></li><li><h4><em>instance.</em><span>doubledelete</span></h4><p>Boolean representing whether doubledelete is enabled.</p></li><li><h4><em>instance.</em><span>multiple</span></h4><p>Boolean representing if the use can select more than one result.</p></li><li><h4><em>instance.</em><span>capacity</span></h4><p>Boolean representing if the autocomplete is at max selections.</p></li><li><h4><em>instance.</em><span>anything</span></h4><p>Boolean representing if the autocomplete will accept any value or only a value from the result list.</p></li><li><h4><em>instance.</em><span>value</span></h4><p>String value set on your root's input element. The value is flattened, which means it's an object that's been base64 encoded.</p></li><li><h4><em>instance.</em><span>empty</span></h4><p>Boolean representing if we have no results.</p></li><li><h4><em>instance.</em><span>remote</span></h4><p>Boolean representing if our instance is equipt to make XHR requests for data.</p></li><li><h4><em>instance.</em><span>deletecount</span></h4><p>How many times delete has been pressed in a row. Used with doubledelete.</p></li><li><h4><em>instance.</em><span>selections</span></h4><p>Array of objects holding the value/label pairs currently selected.</p></li><li><h4><em>instance.</em><span>requests</span></h4><p>How many requests have been kicked off in total.</p></li><li><h4><em>instance.</em><span>cache</span></h4><p>Object containing all cached requests.</p></li><li><h4><em>instance.</em><span>query</span></h4><p>The current query string.</p></li></ul></div></div></main><script type="text/javascript" language="javascript" src="../docs/assets/js/prism.js"></script><script type="text/javascript" language="javascript" src="../src/js/core.js"></script><script type="text/javascript" src="../docs/assets/js/jquery.js"></script><script type="text/javascript" src="../src/js/selectmenu.js"></script><script type="text/javascript" src="../src/js/autocomplete.js"></script><script>Mk.transitions.enable();

var inputs = Mk.$('.mk-ac-root'),
	Autocomplete = Mk.get('Autocomplete'),
	autocomplete;

inputs.each(function (el) {

	if (el.id && el.id === 'remote') {

		autocomplete = new Autocomplete(el, {
			events: {
				'create.tag': function (obj) {
					obj.label = obj.raw.value;
				},
				'request.send': function (query, requestnum) {

					var ac = this;

					$.ajax({
						url: 'http://dev.markitondemand.com/Api/v2/Lookup/jsonp',
						data: {input: query},
						type: 'get',
						dataType: 'jsonp',
						success: function (data) {

							if (ac.requests !== requestnum) {
								ac.abort();
								return;
							}

							ac.each(data, function (obj) {
								obj.label = obj.Name;
								obj.value = obj.Symbol;
							});

							ac.setCache(query, data);
							ac.render(data, query);
						},
						error: function () {
							ac.emit('request.error');
						}
					});
				}
			}
		});
	}
	else {

		autocomplete = new Autocomplete(el, {
			data: [{
				label: 'Comedy',
				value: 'Comedy'
			},
			{
				label: 'Horror',
				value: 'Horror'
			},
			{
				label: 'Thriller',
				value: 'Thriller'
			},
			{
				label: 'Disney',
				value: 'Disney'
			},
			{
				label: 'Action',
				value: 'Action'
			},
			{
				label: 'Adventure',
				value: 'Adventure'
			},
			{
				label: 'Fantasy',
				value: 'Fantasy'
			},
			{
				label: 'SyFi',
				value: 'SyFi'
			},
			{
				label: 'Drama',
				value: 'Drama'
			},
			{
				label: 'Romance',
				value: 'Romance'
			},
			{
				label: 'Independent',
				value: 'Independent'
			}]
		});
	}

	autocomplete.on('activate', function (node, keyboard) {

		if (keyboard) {

			var data = this.unflatten(
					node.attr('data-value'));

			this.input.val(data.value);
		}
	});

	autocomplete.on('change', function () {
		console.info('selections (raw):', this.selections);
		console.info('value (base64):', this.value)
	});
});</script></body></html>