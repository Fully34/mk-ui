!function(t,o){if("function"==typeof define&&define.amd)define(["mk"],function(i){return o(t,i)});else{if("object"!=typeof module||!module.exports)return o(t,t.Mk);module.exports=o(t,require("mk"))}}("undefined"!=typeof window&&window||this,function(t,o){if("undefined"==typeof o.Tooltip)throw new Error("Mk.Dialog: Tooltip base class not found.");return o.create("Dialog",o.Tooltip,{name:"mk-dg",modal:null,get _locked(){return this.root.hasClass("-locked")},get _unlocked(){return!this._locked},get locked(){return this.root.hasClass("locked")},get unlocked(){return!this.locked},get isOpen(){return"false"===this.modal.attr("aria-hidden")},get isHidden(){return!this.isOpen},get focusable(){return this.isFocusable(this.modal)},configure:function(t){t=t||{},t.position=t.position||"bottom-left",this.param("arrow","boolean",t,!1),this.super(t)},mount:function(){this.link(),this.modal=this.$("#"+this.root.attr("aria-describedby")),this.config.arrow&&this.modal.addClass("arrow")},unmount:function(){var t=this.root;this.$(document.documentElement).off("mousedown"+this.selector(),this._mousedown),this.each("click,mouseenter,mouseleave,focus,blur,keyup".split(","),function(o){t.off(o+".mk")}),this.root=this.modal=this.config=this._mousedown=null},bind:function(){var t=this;this.root.on("click.mk",function(o){o.preventDefault(),t._click()}).on("mouseenter.mk",function(o){o.preventDefault(),t._over(!1)}).on("mouseleave.mk",function(o){o.preventDefault(),t._out(!1)}).on("focus.mk",function(o){o.preventDefault(),t._over(!0)}).on("blur.mk",function(o){o.preventDefault(),t._out(!0)}).on("keyup.mk",function(o){t._keyup(o)}),this._mousedown=function(o){return t._down(o)},this.$(document.documentElement).on("mousedown"+this.selector(),this._mousedown)},_mousedown:null,_keyup:function(t){t.which===this.keycode.esc&&this._unlock().hide()},_click:function(){(this.device||"click"===this.root.data("action"))&&this.toggle()},_over:function(t){this.device||"click"===this.root.data("action")||(this.show(),t&&this.focusable&&this._lock())},_down:function(t){if(!this.isHidden){var o=this.$(t.target),i=this.selector(),e=this.selector("modal"),s=o.is(i)?o:o.closest(i),n=o.is(e)?o:o.closest(e);return n.length>0||s.length>0?((n[0]===this.modal[0]&&"close"===o.data("action")||n.length<1&&s[0]!==this.root[0])&&(t.preventDefault(),this.hide()),!1):this.hideAll()}},_out:function(t){this.device||"click"===this.root.data("action")||(!t&&this.focusable&&this._unlock(),this.hide())},_lock:function(){return this.root.addClass("-locked"),this},_unlock:function(){return this.root.removeClass("-locked"),this},link:function(){return this.super(this.root)},position:function(){return this.super(this.root,this.modal)},focus:function(){var t=this.root,o=this.modal.find(this.selector("kill"));return o.length<1&&(o=this.html("kill"),o.on("focus.mk",function(){t.focus()}),this.modal.append(o)),this},show:function(t){return this._unlocked&&this.unlocked&&(this.hideAll(),this.delay(function(){this.modal.removeClass("out").addClass("in").attr("aria-hidden","false"),this.position(),this.focusable&&this.focus(),this.root.addClass("active"),t||this.emit("show",this.root[0],this.modal[0])}),this.transition(this.modal,function(t,o){o.removeClass("in")})),this},hide:function(t,o){var i,e=this.root.attr("data-action");return this._unlocked&&this.unlocked&&(i=t!==!0&&"click"!==e&&this.focusable&&this.config.delay||0,this.delay(function(){this.modal.removeClass("in").addClass("out").attr("aria-hidden","true"),t!==!0&&this.transitions||(this.modal.removeClass("out"),this.clearTransitions(this.modal)),this.root.removeClass("active"),o||this.emit("hide",this.root[0],this.modal[0])},i),this.transition(this.modal,function(t,o){o.removeClass("out")})),this},hideAll:function(){return this.hide()},toggle:function(){return this.isOpen?this.hide():this.show()},lock:function(){return this.root.hasClass("locked")||(this.root.addClass("locked"),this.emit("lock",this.root[0],!0)),this},unlock:function(){return this.root.hasClass("locked")&&(this.root.removeClass("locked"),this.emit("lock",this.root[0],!1)),this}}),o.get("Dialog")});